Loading model from /home/ergale/projects/LDM-diffusion-sem/logs_no_attn_loss/2024-01-17T14-33-09_diffusion-sem/checkpoints/last.ckpt
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 439.94 M params.
Keeping EMAs of 707.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 3, 64, 64) = 12288 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/first_stage_models/vq-f4/model.ckpt with 0 missing and 55 unexpected keys
Sampling:   0%|          | 0/1 [00:00<?, ?it/s]Data shape for DDIM sampling is (8, 3, 64, 64), eta 0.0
Running DDIM Sampling with 200 timesteps

DDIM Sampler:   0%|          | 0/200 [00:00<?, ?it/s][A
DDIM Sampler:   0%|          | 1/200 [00:00<00:39,  5.02it/s][A
DDIM Sampler:   1%|          | 2/200 [00:00<00:32,  6.12it/s][A
DDIM Sampler:   2%|â–         | 3/200 [00:00<00:29,  6.61it/s][A
DDIM Sampler:   2%|â–         | 4/200 [00:00<00:28,  6.85it/s][A
DDIM Sampler:   2%|â–Ž         | 5/200 [00:00<00:27,  6.98it/s][A
DDIM Sampler:   3%|â–Ž         | 6/200 [00:00<00:27,  7.06it/s][A
DDIM Sampler:   4%|â–Ž         | 7/200 [00:01<00:27,  7.12it/s][A
DDIM Sampler:   4%|â–         | 8/200 [00:01<00:26,  7.16it/s][A
DDIM Sampler:   4%|â–         | 9/200 [00:01<00:26,  7.18it/s][A
DDIM Sampler:   5%|â–Œ         | 10/200 [00:01<00:26,  7.19it/s][A
DDIM Sampler:   6%|â–Œ         | 11/200 [00:01<00:26,  7.20it/s][A
DDIM Sampler:   6%|â–Œ         | 12/200 [00:01<00:26,  7.22it/s][A
DDIM Sampler:   6%|â–‹         | 13/200 [00:01<00:25,  7.22it/s][A
DDIM Sampler:   7%|â–‹         | 14/200 [00:01<00:25,  7.22it/s][A
DDIM Sampler:   8%|â–Š         | 15/200 [00:02<00:25,  7.23it/s][A
DDIM Sampler:   8%|â–Š         | 16/200 [00:02<00:25,  7.23it/s][A
DDIM Sampler:   8%|â–Š         | 17/200 [00:02<00:25,  7.22it/s][A
DDIM Sampler:   9%|â–‰         | 18/200 [00:02<00:25,  7.21it/s][A
DDIM Sampler:  10%|â–‰         | 19/200 [00:02<00:25,  7.22it/s][A
DDIM Sampler:  10%|â–ˆ         | 20/200 [00:02<00:24,  7.23it/s][A
DDIM Sampler:  10%|â–ˆ         | 21/200 [00:02<00:24,  7.24it/s][A
DDIM Sampler:  11%|â–ˆ         | 22/200 [00:03<00:24,  7.25it/s][A
DDIM Sampler:  12%|â–ˆâ–        | 23/200 [00:03<00:24,  7.25it/s][A
DDIM Sampler:  12%|â–ˆâ–        | 24/200 [00:03<00:24,  7.25it/s][A
DDIM Sampler:  12%|â–ˆâ–Ž        | 25/200 [00:03<00:24,  7.24it/s][A
DDIM Sampler:  13%|â–ˆâ–Ž        | 26/200 [00:03<00:24,  7.24it/s][A
DDIM Sampler:  14%|â–ˆâ–Ž        | 27/200 [00:03<00:23,  7.23it/s][A
DDIM Sampler:  14%|â–ˆâ–        | 28/200 [00:03<00:23,  7.23it/s][A
DDIM Sampler:  14%|â–ˆâ–        | 29/200 [00:04<00:23,  7.23it/s][A
DDIM Sampler:  15%|â–ˆâ–Œ        | 30/200 [00:04<00:23,  7.24it/s][A
DDIM Sampler:  16%|â–ˆâ–Œ        | 31/200 [00:04<00:23,  7.25it/s][A
DDIM Sampler:  16%|â–ˆâ–Œ        | 32/200 [00:04<00:23,  7.25it/s][A
DDIM Sampler:  16%|â–ˆâ–‹        | 33/200 [00:04<00:23,  7.25it/s][A
DDIM Sampler:  17%|â–ˆâ–‹        | 34/200 [00:04<00:22,  7.25it/s][A
DDIM Sampler:  18%|â–ˆâ–Š        | 35/200 [00:04<00:22,  7.25it/s][A
DDIM Sampler:  18%|â–ˆâ–Š        | 36/200 [00:05<00:22,  7.24it/s][A
DDIM Sampler:  18%|â–ˆâ–Š        | 37/200 [00:05<00:22,  7.23it/s][A
DDIM Sampler:  19%|â–ˆâ–‰        | 38/200 [00:05<00:22,  7.22it/s][A
DDIM Sampler:  20%|â–ˆâ–‰        | 39/200 [00:05<00:22,  7.22it/s][A
DDIM Sampler:  20%|â–ˆâ–ˆ        | 40/200 [00:05<00:22,  7.23it/s][A
DDIM Sampler:  20%|â–ˆâ–ˆ        | 41/200 [00:05<00:21,  7.23it/s][A
DDIM Sampler:  21%|â–ˆâ–ˆ        | 42/200 [00:05<00:21,  7.24it/s][A
DDIM Sampler:  22%|â–ˆâ–ˆâ–       | 43/200 [00:06<00:21,  7.24it/s][A
DDIM Sampler:  22%|â–ˆâ–ˆâ–       | 44/200 [00:06<00:21,  7.25it/s][A
DDIM Sampler:  22%|â–ˆâ–ˆâ–Ž       | 45/200 [00:06<00:21,  7.25it/s][A
DDIM Sampler:  23%|â–ˆâ–ˆâ–Ž       | 46/200 [00:06<00:21,  7.26it/s][A
DDIM Sampler:  24%|â–ˆâ–ˆâ–Ž       | 47/200 [00:06<00:21,  7.25it/s][A
DDIM Sampler:  24%|â–ˆâ–ˆâ–       | 48/200 [00:06<00:20,  7.25it/s][A
DDIM Sampler:  24%|â–ˆâ–ˆâ–       | 49/200 [00:06<00:20,  7.24it/s][A
DDIM Sampler:  25%|â–ˆâ–ˆâ–Œ       | 50/200 [00:06<00:20,  7.24it/s][A
DDIM Sampler:  26%|â–ˆâ–ˆâ–Œ       | 51/200 [00:07<00:20,  7.24it/s][A
DDIM Sampler:  26%|â–ˆâ–ˆâ–Œ       | 52/200 [00:07<00:20,  7.25it/s][A
DDIM Sampler:  26%|â–ˆâ–ˆâ–‹       | 53/200 [00:07<00:20,  7.24it/s][A
DDIM Sampler:  27%|â–ˆâ–ˆâ–‹       | 54/200 [00:07<00:20,  7.24it/s][A
DDIM Sampler:  28%|â–ˆâ–ˆâ–Š       | 55/200 [00:07<00:20,  7.24it/s][A
DDIM Sampler:  28%|â–ˆâ–ˆâ–Š       | 56/200 [00:07<00:19,  7.25it/s][A
DDIM Sampler:  28%|â–ˆâ–ˆâ–Š       | 57/200 [00:07<00:19,  7.25it/s][A
DDIM Sampler:  29%|â–ˆâ–ˆâ–‰       | 58/200 [00:08<00:19,  7.15it/s][A
DDIM Sampler:  30%|â–ˆâ–ˆâ–‰       | 59/200 [00:08<00:19,  7.18it/s][A
DDIM Sampler:  30%|â–ˆâ–ˆâ–ˆ       | 60/200 [00:08<00:19,  7.20it/s][A
DDIM Sampler:  30%|â–ˆâ–ˆâ–ˆ       | 61/200 [00:08<00:19,  7.22it/s][A
DDIM Sampler:  31%|â–ˆâ–ˆâ–ˆ       | 62/200 [00:08<00:19,  7.22it/s][A
DDIM Sampler:  32%|â–ˆâ–ˆâ–ˆâ–      | 63/200 [00:08<00:18,  7.22it/s][A
DDIM Sampler:  32%|â–ˆâ–ˆâ–ˆâ–      | 64/200 [00:08<00:18,  7.22it/s][A
DDIM Sampler:  32%|â–ˆâ–ˆâ–ˆâ–Ž      | 65/200 [00:09<00:18,  7.21it/s][A
DDIM Sampler:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 66/200 [00:09<00:18,  7.21it/s][A
DDIM Sampler:  34%|â–ˆâ–ˆâ–ˆâ–Ž      | 67/200 [00:09<00:18,  7.22it/s][A
DDIM Sampler:  34%|â–ˆâ–ˆâ–ˆâ–      | 68/200 [00:09<00:18,  7.23it/s][A
DDIM Sampler:  34%|â–ˆâ–ˆâ–ˆâ–      | 69/200 [00:09<00:18,  7.23it/s][A
DDIM Sampler:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 70/200 [00:09<00:17,  7.24it/s][A
DDIM Sampler:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 71/200 [00:09<00:17,  7.24it/s][A
DDIM Sampler:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 72/200 [00:10<00:17,  7.24it/s][A
DDIM Sampler:  36%|â–ˆâ–ˆâ–ˆâ–‹      | 73/200 [00:10<00:17,  7.24it/s][A
DDIM Sampler:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 74/200 [00:10<00:17,  7.24it/s][A
DDIM Sampler:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 75/200 [00:10<00:17,  7.24it/s][A
DDIM Sampler:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 76/200 [00:10<00:17,  7.23it/s][A
DDIM Sampler:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 77/200 [00:10<00:16,  7.24it/s][A
DDIM Sampler:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 78/200 [00:10<00:16,  7.24it/s][A
DDIM Sampler:  40%|â–ˆâ–ˆâ–ˆâ–‰      | 79/200 [00:10<00:16,  7.24it/s][A
DDIM Sampler:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 80/200 [00:11<00:16,  7.23it/s][A
DDIM Sampler:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 81/200 [00:11<00:16,  7.24it/s][A
DDIM Sampler:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 82/200 [00:11<00:16,  7.25it/s][A
DDIM Sampler:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 83/200 [00:11<00:16,  7.25it/s][A
DDIM Sampler:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 84/200 [00:11<00:16,  7.25it/s][A
DDIM Sampler:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 85/200 [00:11<00:15,  7.25it/s][A
DDIM Sampler:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 86/200 [00:11<00:15,  7.25it/s][A
DDIM Sampler:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 87/200 [00:12<00:15,  7.25it/s][A
DDIM Sampler:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 88/200 [00:12<00:15,  7.24it/s][A
DDIM Sampler:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 89/200 [00:12<00:15,  7.25it/s][A
DDIM Sampler:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 90/200 [00:12<00:15,  7.25it/s][A
DDIM Sampler:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 91/200 [00:12<00:15,  7.25it/s][A
DDIM Sampler:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 92/200 [00:12<00:14,  7.26it/s][A
DDIM Sampler:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 93/200 [00:12<00:14,  7.25it/s][A
DDIM Sampler:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 94/200 [00:13<00:14,  7.25it/s][A
DDIM Sampler:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 95/200 [00:13<00:14,  7.15it/s][A
DDIM Sampler:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 96/200 [00:13<00:14,  7.18it/s][A
DDIM Sampler:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 97/200 [00:13<00:14,  7.20it/s][A
DDIM Sampler:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 98/200 [00:13<00:14,  7.20it/s][A
DDIM Sampler:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 99/200 [00:13<00:14,  7.21it/s][A
DDIM Sampler:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 100/200 [00:13<00:13,  7.21it/s][A
DDIM Sampler:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 101/200 [00:14<00:13,  7.22it/s][A
DDIM Sampler:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 102/200 [00:14<00:13,  7.23it/s][A
DDIM Sampler:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 103/200 [00:14<00:13,  7.24it/s][A
DDIM Sampler:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 104/200 [00:14<00:13,  7.24it/s][A
DDIM Sampler:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 105/200 [00:14<00:13,  7.25it/s][A
DDIM Sampler:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 106/200 [00:14<00:12,  7.25it/s][A
DDIM Sampler:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 107/200 [00:14<00:12,  7.25it/s][A
DDIM Sampler:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 108/200 [00:14<00:12,  7.25it/s][A
DDIM Sampler:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 109/200 [00:15<00:12,  7.25it/s][AGlobal seed set to 23
/home/ergale/.conda/envs/diffusion/lib/python3.8/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:446: UserWarning: Checkpoint directory /home/ergale/projects/LDM-diffusion-sem/logs_no_attn_loss/2024-01-17T14-33-09_diffusion-sem/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
/home/ergale/.conda/envs/diffusion/lib/python3.8/site-packages/pytorch_lightning/trainer/configuration_validator.py:99: UserWarning: you passed in a test_dataloader but have no test_step. Skipping test loop
  rank_zero_warn(f"you passed in a {loader_name} but have no {step_name}. Skipping {stage} loop")
Global seed set to 23
initializing ddp: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All DDP processes registered. Starting ddp with 1 processes
----------------------------------------------------------------------------------------------------

/home/ergale/.conda/envs/diffusion/lib/python3.8/site-packages/pytorch_lightning/core/datamodule.py:423: LightningDeprecationWarning: DataModule.setup has already been called, so it will not be called again. In v1.6 this behavior will change to always call DataModule.setup.
  rank_zero_deprecation(
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [1]
Running on GPUs 0,
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 439.94 M params.
Keeping EMAs of 707.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 3, 64, 64) = 12288 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/first_stage_models/vq-f4/model.ckpt with 0 missing and 55 unexpected keys
Monitoring val/loss_simple_ema as checkpoint metric.
Merged modelckpt-cfg: 
{'target': 'pytorch_lightning.callbacks.ModelCheckpoint', 'params': {'dirpath': '/home/ergale/projects/LDM-diffusion-sem/logs_no_attn_loss/2024-01-17T14-33-09_diffusion-sem/checkpoints', 'filename': '{epoch:06}', 'verbose': True, 'save_last': True, 'monitor': 'val/loss_simple_ema', 'save_top_k': 3}}
#### Data #####
train, CelebAHQ, 27999
validation, CelebAHQ, 2000
test, CelebAHQ, 2000
accumulate_grad_batches = 6
Setting learning rate to 1.92e-04 = 6 (accumulate_grad_batches) * 1 (num_gpus) * 16 (batchsize) * 2.00e-06 (base_lr)

